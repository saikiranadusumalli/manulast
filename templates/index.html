<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Table Management</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        form {
            margin-bottom: 20px;
        }
        input[type="text"], input[type="number"] {
            padding: 5px;
            margin-right: 10px;
        }
        button {
            padding: 5px 10px;
        }
    </style>
</head>
<body>

    <h1>Food Table Management</h1>

    <form id="food-form">
        <input type="text" id="food" placeholder="Food Name" required>
        <input type="number" id="quantity" placeholder="Quantity" required>
        <input type="number" id="price" placeholder="Price" required>
        <button type="submit">Add/Update Food</button>
    </form>

    <table>
        <thead>
            <tr>
                <th>Food</th>
                <th>Quantity</th>
                <th>Price</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="food-table-body">
        </tbody>
    </table>

    <h2>Charts</h2>
    <form id="chart-form">
        <input type="number" id="N" placeholder="Enter N" required>
        <button type="button" onclick="generatePieChart()">Generate Pie Chart</button>
        <button type="button" onclick="generateBarChart()">Generate Bar Chart</button>
    </form>

    <h2>Points</h2>
    <form id="point-form">
        <input type="number" id="x" placeholder="X Value" required>
        <input type="number" id="y" placeholder="Y Value" required>
        <input type="number" id="quantity" placeholder="Quantity" required>
        <button type="submit">Add Point</button>
    </form>

    <table>
        <thead>
            <tr>
                <th>X</th>
                <th>Y</th>
                <th>Quantity</th>
            </tr>
        </thead>
        <tbody id="points-table-body">
        </tbody>
    </table>

    <button type="button" onclick="generateScatterPlot()">Generate Scatter Plot</button>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const foodForm = document.getElementById('food-form');
            const foodTableBody = document.getElementById('food-table-body');
            const pointForm = document.getElementById('point-form');
            const pointsTableBody = document.getElementById('points-table-body');

            foodForm.addEventListener('submit', function(event) {
                event.preventDefault();
                const food = document.getElementById('food').value;
                const quantity = document.getElementById('quantity').value;
                const price = document.getElementById('price').value;

                if (food && quantity && price) {
                    const foodData = {
                        food: food,
                        quantity: parseInt(quantity),
                        price: parseFloat(price)
                    };

                    fetch('/food', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(foodData)
                    })
                    .then(response => response.json())
                    .then(data => {
                        alert(data.message);
                        loadFoodTable();
                    })
                    .catch(error => console.error('Error:', error));
                }
            });

            pointForm.addEventListener('submit', function(event) {
                event.preventDefault();
                const x = document.getElementById('x').value;
                const y = document.getElementById('y').value;
                const quantity = document.getElementById('quantity').value;

                if (x && y && quantity) {
                    const pointData = {
                        x: parseFloat(x),
                        y: parseFloat(y),
                        quantity: parseFloat(quantity)
                    };

                    fetch('/points', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(pointData)
                    })
                    .then(response => response.json())
                    .then(data => {
                        alert(data.message);
                        loadPointsTable();
                    })
                    .catch(error => console.error('Error:', error));
                }
            });

            function loadFoodTable() {
                fetch('/food')
                    .then(response => response.json())
                    .then(data => {
                        foodTableBody.innerHTML = '';
                        data.reverse().forEach(item => {
                            if (item.food && item.quantity != null && item.price != null) {
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td>${item.food}</td>
                                    <td>${item.quantity}</td>
                                    <td>${item.price}</td>
                                    <td>
                                        <button onclick="deleteFood('${item.food}')">Delete</button>
                                    </td>
                                `;
                                foodTableBody.appendChild(row);
                            }
                        });
                    })
                    .catch(error => console.error('Error:', error));
            }

            function loadPointsTable() {
                fetch('/points')
                    .then(response => response.json())
                    .then(data => {
                        pointsTableBody.innerHTML = '';
                        data.reverse().forEach(item => {
                            if (item.x != null && item.y != null && item.quantity != null) {
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td>${item.x}</td>
                                    <td>${item.y}</td>
                                    <td>${item.quantity}</td>
                                `;
                                pointsTableBody.appendChild(row);
                            }
                        });
                    })
                    .catch(error => console.error('Error:', error));
            }

            window.deleteFood = function(food) {
                fetch('/food', {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ food: food })
                })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    loadFoodTable();
                })
                .catch(error => console.error('Error:', error));
            };

            window.generatePieChart = function() {
                const N = document.getElementById('N').value;
                if (N) {
                    window.location.href = `/plot_pie_chart/${N}`;
                }
            };

            window.generateBarChart = function() {
                const N = document.getElementById('N').value;
                if (N) {
                    window.location.href = `/plot_bar_chart/${N}`;
                }
            };

            window.generateScatterPlot = function() {
                window.location.href = `/plot_scatter`;
            };

            loadFoodTable();
            loadPointsTable();
        });
    </script>

</body>
</html>
